{"version":3,"sources":["../../../src/services/order.service.ts"],"sourcesContent":["import { PrismaClient, Order, OrderProduct } from \"@prisma/client\"\r\nimport { HttpException } from \"../exceptions/httpException\"\r\nimport {prisma} from 'database/adapter'\r\n\r\nexport class OrderService {\r\n\r\n    static async getAll() {\r\n        const findOrders = await prisma.order.findMany({ include: { orderProducts: true, user: { select: { id: true } } } })\r\n        if (!findOrders) throw new HttpException(404, \"Orders not found\")\r\n        return findOrders\r\n    }\r\n\r\n    static async getById(id: number) {\r\n        const findOrder = await prisma.order.findUnique({ where: { id } })\r\n        if (!findOrder) throw new HttpException(404, \"Order not found\")\r\n        return findOrder\r\n    }\r\n\r\n\r\n    static async save(orderProducts: OrderProduct[], idUser: number) {\r\n        return await prisma.order.create({\r\n            data: {\r\n                status:\"pending\",\r\n                idUser:idUser,\r\n                orderProducts:{createMany:{data : orderProducts}}\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    static async delete(id: number) {\r\n        const findOrder = await prisma.order.findUnique({ where: { id } })\r\n        if (!findOrder) throw new HttpException(404, \"Order not found\")\r\n        return await prisma.order.delete({ where: { id } })\r\n    }\r\n\r\n\r\n    static async update(order: Order) {\r\n        const { id } = order\r\n        const findOrder = await prisma.order.findUnique({ where: { id } })\r\n        if (!findOrder) throw new HttpException(404, \"Order not found\")\r\n        return await prisma.order.update({ where: { id }, data: { ...order } })\r\n    }\r\n\r\n\r\n}"],"names":["OrderService","getAll","findOrders","prisma","order","findMany","include","orderProducts","user","select","id","HttpException","getById","findOrder","findUnique","where","save","idUser","create","data","status","createMany","delete","update"],"mappings":";;;;+BAIaA;;;eAAAA;;;+BAHiB;yBACT;AAEd,IAAA,AAAMA,eAAN,MAAMA;IAET,aAAaC,SAAS;QAClB,MAAMC,aAAa,MAAMC,eAAM,CAACC,KAAK,CAACC,QAAQ,CAAC;YAAEC,SAAS;gBAAEC,eAAe;gBAAMC,MAAM;oBAAEC,QAAQ;wBAAEC,IAAI;oBAAK;gBAAE;YAAE;QAAE;QAClH,IAAI,CAACR,YAAY,MAAM,IAAIS,4BAAa,CAAC,KAAK;QAC9C,OAAOT;IACX;IAEA,aAAaU,QAAQF,EAAU,EAAE;QAC7B,MAAMG,YAAY,MAAMV,eAAM,CAACC,KAAK,CAACU,UAAU,CAAC;YAAEC,OAAO;gBAAEL;YAAG;QAAE;QAChE,IAAI,CAACG,WAAW,MAAM,IAAIF,4BAAa,CAAC,KAAK;QAC7C,OAAOE;IACX;IAGA,aAAaG,KAAKT,aAA6B,EAAEU,MAAc,EAAE;QAC7D,OAAO,MAAMd,eAAM,CAACC,KAAK,CAACc,MAAM,CAAC;YAC7BC,MAAM;gBACFC,QAAO;gBACPH,QAAOA;gBACPV,eAAc;oBAACc,YAAW;wBAACF,MAAOZ;oBAAa;gBAAC;YACpD;QACJ;IACJ;IAGA,aAAae,OAAOZ,EAAU,EAAE;QAC5B,MAAMG,YAAY,MAAMV,eAAM,CAACC,KAAK,CAACU,UAAU,CAAC;YAAEC,OAAO;gBAAEL;YAAG;QAAE;QAChE,IAAI,CAACG,WAAW,MAAM,IAAIF,4BAAa,CAAC,KAAK;QAC7C,OAAO,MAAMR,eAAM,CAACC,KAAK,CAACkB,MAAM,CAAC;YAAEP,OAAO;gBAAEL;YAAG;QAAE;IACrD;IAGA,aAAaa,OAAOnB,KAAY,EAAE;QAC9B,MAAM,EAAEM,EAAE,EAAE,GAAGN;QACf,MAAMS,YAAY,MAAMV,eAAM,CAACC,KAAK,CAACU,UAAU,CAAC;YAAEC,OAAO;gBAAEL;YAAG;QAAE;QAChE,IAAI,CAACG,WAAW,MAAM,IAAIF,4BAAa,CAAC,KAAK;QAC7C,OAAO,MAAMR,eAAM,CAACC,KAAK,CAACmB,MAAM,CAAC;YAAER,OAAO;gBAAEL;YAAG;YAAGS,MAAM;gBAAE,GAAGf,KAAK;YAAC;QAAE;IACzE;AAGJ"}