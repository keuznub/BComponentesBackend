{"version":3,"sources":["../../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport { AuthService } from \"../services/auth.service\";\r\nimport { log } from \"console\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\n\r\nexport default class AuthController{\r\n\r\n    static async register(req: Request, res:Response, next:NextFunction) {\r\n        try{\r\n        const userData = req.body\r\n        const newUser = await AuthService.register(userData)\r\n        res.status(201).json({message:\"User register succesfully\",user:newUser})\r\n        }catch(error){\r\n            next(error)\r\n        }\r\n\r\n    }\r\n\r\n\r\n    static async login(req: Request, res:Response, next:NextFunction){\r\n        try{\r\n            const userData = req.body\r\n            const token = await AuthService.login(userData)\r\n            res.cookie('token',token, {\r\n                maxAge:60*60*1000,\r\n                httpOnly:true,\r\n                secure:false,\r\n                sameSite:\"strict\"\r\n            })\r\n            \r\n            const {id,role} : any = jwt.decode(token)\r\n    \r\n            res.status(201).json({message:\"Login sucessfully\",id,role})\r\n            }catch(error){\r\n                next(error)\r\n            }\r\n\r\n    }\r\n\r\n    static async logout(req: Request, res:Response, next:NextFunction){\r\n        try{\r\n            res.clearCookie('token', {\r\n                httpOnly:true,\r\n                secure:false,\r\n                sameSite:\"strict\"\r\n            })\r\n            res.status(201).json({message:\"Logout sucessfully\"})\r\n            }catch(error){\r\n                next(error)\r\n            }\r\n\r\n    }\r\n\r\n}"],"names":["AuthController","register","req","res","next","userData","body","newUser","AuthService","status","json","message","user","error","login","token","cookie","maxAge","httpOnly","secure","sameSite","id","role","jwt","decode","logout","clearCookie"],"mappings":";;;;+BAMA;;;eAAqBA;;;6BALO;qEAEZ;;;;;;AAGD,IAAA,AAAMA,iBAAN,MAAMA;IAEjB,aAAaC,SAASC,GAAY,EAAEC,GAAY,EAAEC,IAAiB,EAAE;QACjE,IAAG;YACH,MAAMC,WAAWH,IAAII,IAAI;YACzB,MAAMC,UAAU,MAAMC,wBAAW,CAACP,QAAQ,CAACI;YAC3CF,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;gBAACC,SAAQ;gBAA4BC,MAAKL;YAAO;QACtE,EAAC,OAAMM,OAAM;YACTT,KAAKS;QACT;IAEJ;IAGA,aAAaC,MAAMZ,GAAY,EAAEC,GAAY,EAAEC,IAAiB,EAAC;QAC7D,IAAG;YACC,MAAMC,WAAWH,IAAII,IAAI;YACzB,MAAMS,QAAQ,MAAMP,wBAAW,CAACM,KAAK,CAACT;YACtCF,IAAIa,MAAM,CAAC,SAAQD,OAAO;gBACtBE,QAAO,KAAG,KAAG;gBACbC,UAAS;gBACTC,QAAO;gBACPC,UAAS;YACb;YAEA,MAAM,EAACC,EAAE,EAACC,IAAI,EAAC,GAASC,qBAAG,CAACC,MAAM,CAACT;YAEnCZ,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;gBAACC,SAAQ;gBAAoBU;gBAAGC;YAAI;QACzD,EAAC,OAAMT,OAAM;YACTT,KAAKS;QACT;IAER;IAEA,aAAaY,OAAOvB,GAAY,EAAEC,GAAY,EAAEC,IAAiB,EAAC;QAC9D,IAAG;YACCD,IAAIuB,WAAW,CAAC,SAAS;gBACrBR,UAAS;gBACTC,QAAO;gBACPC,UAAS;YACb;YACAjB,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;gBAACC,SAAQ;YAAoB;QAClD,EAAC,OAAME,OAAM;YACTT,KAAKS;QACT;IAER;AAEJ"}