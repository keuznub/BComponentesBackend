{"version":3,"sources":["../../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport { AuthService } from \"../services/auth.service\";\r\nimport { log } from \"console\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\n\r\nexport default class AuthController{\r\n\r\n    static async register(req: Request, res:Response, next:NextFunction) {\r\n        try{\r\n        const userData = req.body\r\n        const newUser = await AuthService.register(userData)\r\n        res.status(201).json({message:\"User register succesfully\",user:newUser})\r\n        }catch(error){\r\n            next(error)\r\n        }\r\n\r\n    }\r\n\r\n\r\n    static async login(req: Request, res:Response, next:NextFunction){\r\n        try{\r\n            const userData = req.body\r\n            const token = await AuthService.login(userData)\r\n            res.cookie('token',token, {\r\n                maxAge:60*60*1000,\r\n                httpOnly:true,\r\n                secure:false,\r\n                sameSite:\"strict\"\r\n            })\r\n            \r\n            const {id,role} = jwt.decode(token)\r\n    \r\n            res.status(201).json({message:\"Login sucessfully\",id,role})\r\n            }catch(error){\r\n                next(error)\r\n            }\r\n\r\n    }\r\n\r\n    static async logout(req: Request, res:Response, next:NextFunction){\r\n        try{\r\n            res.clearCookie('token', {\r\n                httpOnly:true,\r\n                secure:false,\r\n                sameSite:\"strict\"\r\n            })\r\n            res.status(201).json({message:\"Logout sucessfully\"})\r\n            }catch(error){\r\n                next(error)\r\n            }\r\n\r\n    }\r\n\r\n}"],"names":["AuthService","jwt","AuthController","register","req","res","next","userData","newUser","error","body","status","json","message","user","login","token","id","role","cookie","maxAge","httpOnly","secure","sameSite","decode","logout","clearCookie"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,SAASA,WAAW,QAAQ,2BAA2B;AAEvD,OAAOC,SAAS,eAAe;AAGhB,IAAA,AAAMC,+BAAN;;aAAMA;gCAAAA;;kBAAAA;;YAEJC,KAAAA;mBAAb,SAAaA,SAASC,GAAY,EAAEC,GAAY,EAAEC,IAAiB;uBAAnE,oBAAA;wBAEUC,UACAC,SAECC;;;;;;;;;;gCAHDF,WAAWH,IAAIM,IAAI;gCACT;;oCAAMV,YAAYG,QAAQ,CAACI;;;gCAArCC,UAAU;gCAChBH,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oCAACC,SAAQ;oCAA4BC,MAAKN;gCAAO;;;;;;gCAC/DC;gCACHH,KAAKG;;;;;;;;;;;gBAGb;;;;YAGaM,KAAAA;mBAAb,SAAaA,MAAMX,GAAY,EAAEC,GAAY,EAAEC,IAAiB;uBAAhE,oBAAA;wBAEcC,UACAS,OAQYf,aAAXgB,IAAGC,MAGHT;;;;;;;;;;gCAZDF,WAAWH,IAAIM,IAAI;gCACX;;oCAAMV,YAAYe,KAAK,CAACR;;;gCAAhCS,QAAQ;gCACdX,IAAIc,MAAM,CAAC,SAAQH,OAAO;oCACtBI,QAAO,KAAG,KAAG;oCACbC,UAAS;oCACTC,QAAO;oCACPC,UAAS;gCACb;gCAEkBtB,cAAAA,IAAIuB,MAAM,CAACR,QAAtBC,KAAWhB,YAAXgB,IAAGC,OAAQjB,YAARiB;gCAEVb,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;oCAACC,SAAQ;oCAAoBI,IAAAA;oCAAGC,MAAAA;gCAAI;;;;;;gCAClDT;gCACHH,KAAKG;;;;;;;;;;;gBAGjB;;;;YAEagB,KAAAA;mBAAb,SAAaA,OAAOrB,GAAY,EAAEC,GAAY,EAAEC,IAAiB;uBAAjE,oBAAA;;wBACI,IAAG;4BACCD,IAAIqB,WAAW,CAAC,SAAS;gCACrBL,UAAS;gCACTC,QAAO;gCACPC,UAAS;4BACb;4BACAlB,IAAIM,MAAM,CAAC,KAAKC,IAAI,CAAC;gCAACC,SAAQ;4BAAoB;wBAClD,EAAC,OAAMJ,OAAM;4BACTH,KAAKG;wBACT;;;;;gBAER;;;;WA9CiBP;;AAArB,SAAqBA,4BAgDpB"}